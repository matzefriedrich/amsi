namespace Windows.Security.AntiMalwareScan.UnitTest
{
    using System.IO;
    using Xunit;

    public sealed class AmsiExtensionsTest
    {
        [Fact]
        public void AmsiExtensions_Scan_stream_Test()
        {
            // Arrange
            const string appName = "amsitest";

            using var context = AmsiContext.Create(appName);
            using var sut = AmsiSession.Create(context);

            const string filename = "Data/pure-air.txt";
            using Stream stream = File.OpenRead(filename);

            // Act
            AmsiScanResult actual = sut.Scan(stream, filename);

            // Assert
            Assert.Equal(AmsiScanResult.Clean, actual);
        }

        [Fact]
        public void AmsiExtensions_ScanFile_Test()
        {
            // Arrange
            const string appName = "amsitest";

            using var context = AmsiContext.Create(appName);
            using var sut = AmsiSession.Create(context);

            const string filename = "Data/pure-air.txt";

            // Act
            AmsiScanResult actual = sut.ScanFile(filename);

            // Assert
            Assert.Equal(AmsiScanResult.Clean, actual);
        }
    }
}